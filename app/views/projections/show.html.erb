<div class="container">
  <div class="row">
    <div class="col-sm-8 col-sm-offset-2">
      <%= link_to "< All projections", projections_path %>
      <h1><%= @projection.name %></h1>
      <% if current_user == @projection.user %>
        <%= link_to "Edit", edit_projection_path(@projection) %>
      <% end %>
      <h4>Address: <%= @projection.address %></h4>
      <h4>Date: <%= @projection.date %></h4>
      <h4>Capacity: <%= @projection.capacity %></h4>
      <h4>Places restantes: <%= @projection.capacity - @projection.bookings.length %></h4>
      <h4>

        <div style="display: flex; flex-direction: row, justify-content: flex-start">
          <div>Participants:</div>
          <% @projection.bookings.each do |booking| %>
            <%= booking.user.first_name + " " + booking.user.last_name %>
          <% end %>
        </div>
      </h4>
      <h4>Organizer: <%= @projection.user.first_name %></h4>
      <ul>
        <% if user_signed_in? %>
          <% if (@projection.reviews & current_user.reviews).empty? && !(@projection.bookings & current_user.bookings).empty? %>
            <li>
              <%= simple_form_for @new_review do |f| %>
                <%= f.error_notification %>
                <% booking = Booking.where(user: current_user, projection: @projection).first %>
                <%= f.input :booking_id, as: :hidden, input_html: { value: booking.id } %>
                <%= f.input :content %>
                <%= f.input :rating %>
                <%= f.button :submit, "Review" %>
              <% end %>
            </li>
          <% end %>
        <% end %>
        <% @reviews.each do |review| %>
          <li>
            <ul>
              <li><%= review.booking.user.first_name + " " + review.booking.user.last_name %></li>
              <li><%= review.content %></li>
              <li><%= "X" * review.rating %></li>
              <li><%= review.created_at %></li>
            </ul>
            </br>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>
